# Домашнее задание к занятию «Репликация и резервное копирование»### Цель заданияВыполнив это задание, вы:1. Научитесь работать с WAL-логами.2. Попрактикуетесь в настройке механизма логической репликации.3. Поработаете с процедурами резервного копирования.------### Чеклист готовности к домашнему заданию1. Есть ранее созданная БД PostgreSQL для выполнения заданий.### ПререквизитыПоднять второй экземпляр PostgreSQL с новой БД — «test2» для выполнения задач по репликации. Для этого:1. Создайте второй экземпляр, выполните команду:  ``/usr/lib/postgresql/15/bin/initdb -D /var/lib/postgresql/15_2/main``.   2. Для работы экземпляра требуется сменить порт работы с дефолтного 5432, на котором работает 1-ый экземпляр, на порт 5433, на котором будет работать 2-ой экземпляр.Выполните команду: ``vi /var/lib/postgresql/15_2/main/postgresql.conf``, где /var/lib/postgresql/15_2/main/postgresql.conf является файлом конфигурации 2-го экземпляра PostgreSQL.  3. Запустите второй экземпляр. Выполните команду:  ``/usr/lib/postgresql/15/bin/pg_ctl -D /var/lib/postgresql/15_2/main start``.   4. Если потребуется перезапустить 2-ой экземпляр, выполните команду:  ``/usr/lib/postgresql/15/bin/pg_ctl -D /var/lib/postgresql/15_2/main restart``.---### Задание 11. Проверьте текущую роль сервера, определите текущий сгенерированный WAL-лог, выполнив команду в соответствии с ролью сервера. Покажите, что на файловой системе этот последний лог является свежим изменяемым логом: используйте команду shell 'ls'.2. Сделайте дамп таблицы tab1 с данными в тестовой БД test и импортируйте его в БД test2.3. Удалите все данные из импортированной таблицы tab1, с которой работали в пункте 2 этого задания, в БД test2 и настройте репликацию для неё в БД test2 из БД test с репликаций операций только update. Убедитесь, что репликация работает при выполнении апдейтов в БД test и что операции insert не реплицируются.### Задание 21. Определите текущий сгенерированный WAL-лог на сервере, а затем выполните команду переключения WAL-лога. Подтвердите, что он переключился: номер лога изменился.2. Сделайте дамп таблицы tab1 в тестовой БД test и импортируйте его в БД test2 без данных, то есть таблица в БД test2 должна быть пустой.3. Настройте репликацию для БД test2 из БД test для таблицы tab1, с которой работали в пункте 2 этого задания, с репликацией только insert и update операций. Убедитесь, что репликация работает:  - при выполнении любых операций в БД test;  - в БД test2 реплицируются только операции insert и update;  - не попадают другие операции, например delete.### Задание 3*1. Создайте таблицу tab2 с колонками и данными по вашему усмотрению, с primary key, в БД test и настройте для неё репликацию в БД test2 всех операций с указанием как replica identity первичного ключа.2. Выполните бэкап таблицы tab2, с которой работали в пункте 2 этого задания, в таком формате, чтобы его можно было импортировать командой pg_restore. Удалите эту таблицу и подписку в БД test2 и выполните импортирование этой таблицы вместо удалённой реплицируемой: восстановите таблицу с дампа-бэкапа.------### Правила приёма работы* В личном кабинете отправлена ссылка на Google Документ с выполненным заданием.   * В документе настроены права доступа «Просматривать могут все в интернете, у кого есть ссылка».------### Критерии оценкиЗачёт ставится, если выполнены все задания, ответы даны в развёрнутой форме, приложены соответствующие скриншоты и файлы проекта, в выполненных заданиях нет противоречий и нарушения логики.На доработку работу отправят, если задание выполнено частично или не выполнено, в логике выполнения есть противоречия, существенные недостатки.